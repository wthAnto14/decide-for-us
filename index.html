<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <title>Decide for Us</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background-color: #000;
      color: white;
      overflow: hidden;
      user-select: none;
    }

    #header {
      text-align: center;
      font-size: 2.8rem;
      font-weight: 900;
      padding: 20px 0 10px 0;
      background: linear-gradient(90deg, #FF0000, #FF7F00, #FFFF00, #00FF00, #0000FF, #4B0082, #8B00FF);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      letter-spacing: 2px;
    }

    #areaTouch {
      width: 100vw;
      height: 65vh;
      max-height: 500px;
      margin: 0 auto;
      background: #111;
      position: relative;
      border-radius: 10px;
      box-shadow: 0 0 15px 3px rgba(255 255 255 / 0.1);
    }

    #menu {
      height: 70px;
      background: #222;
      color: white;
      display: flex;
      justify-content: space-around;
      align-items: center;
      font-size: 20px;
      font-weight: 700;
    }

    #menu div {
      cursor: pointer;
      padding: 12px 20px;
      border-radius: 12px;
      transition: background-color 0.3s ease;
    }

    #menu .active {
      background-color: #555;
    }

    #namesInput, #pickNameBtn {
      margin: 10px;
      padding: 12px;
      font-size: 18px;
      border-radius: 8px;
      border: none;
      outline: none;
      box-shadow: 0 0 10px rgba(255 255 255 / 0.2);
    }

    #namesInput {
      width: 70%;
      max-width: 400px;
      color: #000;
    }

    #pickNameBtn {
      background-color: #444;
      color: white;
      cursor: pointer;
    }

    #pickNameBtn:hover {
      background-color: #666;
    }

    #namesInput.error {
      border: 2px solid red;
      outline: none;
    }

    #namesArea, #fingersArea {
      padding: 15px;
      background: #111;
      border-radius: 8px;
      margin: 15px auto;
      max-width: 600px;
      text-align: center;
    }

    #resultNames {
      margin-top: 10px;
      font-size: 20px;
      font-weight: 600;
    }

    #resultNames.error {
      color: red;
    }

    #countdown {
      font-size: 20px;
      margin-top: 10px;
      font-weight: 600;
      color: white;
    }
  </style>
</head>
<body>

<div id="header">Decide For Us</div>

<div id="areaTouch"></div>

<div id="fingersArea">
  <div id="resultFingers">Appoggia almeno 2 dita per iniziare la scelta.</div>
  <div id="countdown"></div>
</div>

<div id="namesArea" style="display: none;">
  <input type="text" id="namesInput" placeholder="Inserisci nomi separati da virgola" />
  <button id="pickNameBtn">Scegli un nome</button>
  <div id="resultNames"></div>
</div>

<div id="menu">
  <div id="modeFingers" class="active">‚òùÔ∏è Fingers</div>
  <div id="modeNames">üî† Names</div>
</div>

<script>
  const pickNameBtn = document.getElementById('pickNameBtn');
  const resultNames = document.getElementById('resultNames');
  const namesInput = document.getElementById('namesInput');
  const modeFingers = document.getElementById('modeFingers');
  const modeNames = document.getElementById('modeNames');
  const fingersArea = document.getElementById('fingersArea');
  const namesArea = document.getElementById('namesArea');
  const areaTouch = document.getElementById('areaTouch');

  let activeMode = 'fingers';

  function setActiveMode(mode) {
    activeMode = mode;
    if (mode === 'fingers') {
      fingersArea.style.display = 'block';
      namesArea.style.display = 'none';
      areaTouch.style.display = 'block';
      modeFingers.classList.add('active');
      modeNames.classList.remove('active');
    } else {
      fingersArea.style.display = 'none';
      namesArea.style.display = 'block';
      areaTouch.style.display = 'none';
      modeFingers.classList.remove('active');
      modeNames.classList.add('active');
    }
  }

  function pickName() {
    if (activeMode !== 'names') return;

    const input = namesInput.value.trim();
    if (!input) {
      resultNames.textContent = 'Inserisci almeno due nomi.';
      resultNames.classList.add('error');
      namesInput.classList.add('error');
      return;
    }

    const names = input
      .split(',')
      .map(n => n.trim())
      .filter(n => n.length > 0);

    if (names.length < 2) {
      resultNames.textContent = 'Inserisci almeno due nomi per effettuare una scelta.';
      resultNames.classList.add('error');
      namesInput.classList.add('error');
      return;
    }

    const seen = new Set();
    const hasDuplicates = names.some(name => {
      if (seen.has(name)) return true;
      seen.add(name);
      return false;
    });

    if (hasDuplicates) {
      resultNames.textContent = 'I nomi devono essere tutti diversi (rispettando maiuscole/minuscole).';
      resultNames.classList.add('error');
      namesInput.classList.add('error');
      return;
    }

    // Reset error style
    resultNames.classList.remove('error');
    namesInput.classList.remove('error');

    // Scelta casuale sicura
    const array = new Uint32Array(1);
    window.crypto.getRandomValues(array);
    const idx = array[0] % names.length;
    resultNames.textContent = `Nome scelto: ${names[idx]}`;

    // Vibrazione breve (solo se supportata)
    if (navigator.vibrate) {
      navigator.vibrate(150);
    }
  }

  pickNameBtn.addEventListener('click', pickName);
  modeFingers.addEventListener('click', () => setActiveMode('fingers'));
  modeNames.addEventListener('click', () => setActiveMode('names'));

  // Avvia in modalit√† Fingers
  setActiveMode('fingers');
</script>

</body>
</html>
